<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>


    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=7d87331b-dd51-4b22-8bcc-33b5e5f1080c&=" role="button" class="exportLink">Business Commercial Export</a> <br>
    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=455b25e8-50fd-4f5e-b9f4-e4f2c3efa61d" role="button" class="exportLink">Civil Institutions Export</a> <br>
    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=e1bc0e59-1517-4aa1-a48b-751f14e0ae92" role="button" class="exportLink">Filling Stations Export</a> <br>
    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=356f16e2-d7f6-410d-8c8b-edbdc0290185" role="button" class="exportLink">Guest Houses Or Hotels Export</a> <br>
    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=0b62dc5c-3261-4181-83d2-8b447f047a7a" role="button" class="exportLink">Residential Export </a> <br>
    <a href="https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=a05e5024-4aed-47af-a4d9-4007945cc664" role="button" class="exportLink">Vacant Land Export </a> <br>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/table2excel@1.0.4/dist/table2excel.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        document.querySelector('.exportLink').addEventListener('click', function (event) {
            event.preventDefault(); // Prevent the link from opening
            exportTableToExcel();
        });

        function exportTableToExcel() {
            // Fetch the table data from the HTML page
            fetch('https://ghprodsrv03.giscoe.com/GiscoeInternalSystem/Themes/DF/EBuget/Master.aspx?Proc=U1428510935144&pid=455b25e8-50fd-4f5e-b9f4-e4f2c3efa61d')
                .then(response => response.text())
                .then(data => {
                    // Create a temporary HTML element to extract the table data
                    const tempElement = document.createElement('div');
                    tempElement.innerHTML = data;

                    // Find the table and export it to Excel
                    const table = tempElement.querySelector('table');
                    if (table) {
                        Table2Excel.export(table);
                    } else {
                        console.error('Table not found on the HTML page.');
                    }
                })
                .catch(error => {
                    console.error('Error fetching the HTML page:', error);
                });
        }
    </script>

</body>
</html>
